(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4484:(e,s,t)=>{Promise.resolve().then(t.bind(t,8275))},8275:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(5155),a=t(2115);let n={us:["AAPL","MSFT","GOOGL","TSLA"],japan:["7203.T","6758.T","7267.T","6861.T"]};function l(e){let{onAnalyze:s,isAnalyzing:t=!1,placeholder:l="例: AAPL, 7203.T",popularStocks:i=n,className:c=""}=e,[o,d]=(0,a.useState)(""),[m,x]=(0,a.useState)(""),h=(0,a.useId)(),u=(0,a.useId)(),g=e=>{let s=e.trim();return s?/^[A-Z0-9.-]+$/.test(s)?s.length>20?"シンボルは20文字以内で入力してください。":"":"無効な文字が含まれています。英数字、ドット、ハイフンのみ使用可能です。":""},p=e=>{t||(d(e),x(""))};(0,a.useEffect)(()=>{if(o){let e=g(o);e!==m&&x(e)}},[o,m]);let N=!o.trim()||!!m||t;return(0,r.jsxs)("div",{className:"w-full max-w-md mx-auto space-y-6 ".concat(c),children:[(0,r.jsx)("form",{onSubmit:e=>{if(e.preventDefault(),t)return;let r=o.trim();if(!r)return;let a=g(r);if(a)return void x(a);try{s(r),x("")}catch(e){console.error("Error during analysis callback:",e),x("分析の開始中にエラーが発生しました。")}},className:"card",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:h,className:"block text-sm font-medium text-neutral-700 mb-2",children:"銘柄シンボル"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",id:h,value:o,onChange:e=>{let s=e.target.value.toUpperCase();d(s),m&&s!==o&&x("")},placeholder:l,disabled:t,"aria-label":"銘柄シンボルを入力してください","aria-describedby":m?u:void 0,"aria-invalid":!!m,className:"block w-full rounded-md border px-3 py-2 text-sm placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-100 disabled:cursor-not-allowed ".concat(m?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-neutral-300")}),o&&!t&&(0,r.jsx)("button",{type:"button",onClick:()=>{t||(d(""),x(""))},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-neutral-400 hover:text-neutral-600 focus:outline-none","aria-label":"クリア",children:(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("p",{className:"mt-2 text-xs text-neutral-500",children:"米国株（AAPL）または日本株（7203.T）のシンボルを入力してください"}),m&&(0,r.jsx)("p",{id:u,role:"alert",className:"mt-2 text-sm text-red-600",children:m})]}),(0,r.jsx)("button",{type:"submit",disabled:N,className:"w-full rounded-md bg-primary-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:bg-neutral-400 transition-colors",children:t?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("div",{className:"loading-spinner mr-2 h-4 w-4"}),"分析中..."]}):"月次スイング分析実行"})]})}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h4",{className:"card-title text-sm mb-3",children:"米国株"}),(0,r.jsx)("div",{className:"space-y-2",children:i.us.map(e=>(0,r.jsx)("button",{onClick:()=>p(e),disabled:t,className:"block w-full rounded bg-neutral-100 px-3 py-2 text-left text-sm font-mono text-neutral-700 hover:bg-neutral-200 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e},e))})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h4",{className:"card-title text-sm mb-3",children:"日本株"}),(0,r.jsx)("div",{className:"space-y-2",children:i.japan.map(e=>(0,r.jsx)("button",{onClick:()=>p(e),disabled:t,className:"block w-full rounded bg-neutral-100 px-3 py-2 text-left text-sm font-mono text-neutral-700 hover:bg-neutral-200 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e},e))})]})]})]})}var i=t(2454);let c={baseUrl:t(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:8001",timeout:3e4,retries:3};class o extends Error{constructor(e,s,t,r){super(s),this.name="MonthlySwingApiError",this.status=e,this.code=t,this.details=r}}class d{async request(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="".concat(c.baseUrl).concat(e),r=new AbortController,a=setTimeout(()=>{r.abort()},c.timeout);try{let e=await fetch(t,{...s,headers:{"Content-Type":"application/json",Accept:"application/json",...s.headers},signal:r.signal});if(clearTimeout(a),!e.ok){let s;try{s=await e.json()}catch(t){s={message:e.statusText}}throw new o(e.status,s.message||"HTTP ".concat(e.status,": ").concat(e.statusText),s.code,s.details)}return await e.json()}catch(e){if(clearTimeout(a),e instanceof Error){if("AbortError"===e.name)throw new o(408,"Request timeout","TIMEOUT_ERROR");if(e.message.includes("fetch"))throw new o(0,"Network error - Unable to connect to the analysis service","NETWORK_ERROR")}if(e instanceof o)throw e;throw new o(500,e instanceof Error?e.message:"Unknown error","UNKNOWN_ERROR",e)}}async get(e){return this.request(e,{method:"GET"})}async post(e,s){return this.request(e,{method:"POST",body:JSON.stringify(s)})}}class m{async getAnalysis(e,s){let t=e.trim().toUpperCase();if(!t||0===t.length)throw new o(400,"Stock symbol is required","INVALID_SYMBOL");console.log("[Monthly Swing API] Requesting analysis for symbol: ".concat(t));try{let e=await this.httpClient.get("/api/v1/monthly-swing/analysis/".concat(encodeURIComponent(t)));if(console.log("[Monthly Swing API] Received response for ".concat(t)),!e.success||!e.data){var r,a,n;throw new o(500,(null==(r=e.error)?void 0:r.message)||"Analysis failed",(null==(a=e.error)?void 0:a.code)||"ANALYSIS_FAILED",null==(n=e.error)?void 0:n.details)}return e.data}catch(e){if(console.error("[Monthly Swing API] Analysis failed for ".concat(t,":"),e),e instanceof o)throw e;throw new o(500,"Unexpected error during analysis","UNEXPECTED_ERROR",e)}}async checkHealth(){try{return await this.httpClient.get("/health")}catch(e){throw console.error("[Monthly Swing API] Health check failed:",e),e}}constructor(){this.httpClient=new d}}let x=new m,h={isMonthlySwingApiError:e=>e instanceof o,getErrorMessage(e){var s;if(e instanceof o){switch(e.code){case"INVALID_SYMBOL":return"無効な銘柄シンボルです。シンボルを確認して再試行してください。";case"TIMEOUT_ERROR":return"リクエストがタイムアウトしました。しばらく後に再試行してください。";case"NETWORK_ERROR":return"ネットワークエラーが発生しました。接続を確認してください。";case"DATA_NOT_FOUND":return"指定された銘柄のデータが見つかりません。シンボルを確認してください。";case"INSUFFICIENT_DATA":return"データが不足しているため、分析を実行できません。";case"ANALYSIS_FAILED":return"分析の実行に失敗しました。しばらく後に再試行してください。"}switch(e.status){case 400:return"無効なリクエストです。入力内容を確認してください。";case 404:return"リソースが見つかりません。銘柄シンボルを確認してください。";case 429:return"リクエスト数が上限に達しました。しばらく後に再試行してください。";case 500:return"サーバーエラーが発生しました。しばらく後に再試行してください。";case 503:return"サービスが一時的に利用できません。しばらく後に再試行してください。";default:return e.message||"予期しないエラーが発生しました。"}}return(null==e?void 0:e.name)==="AbortError"?"リクエストがタイムアウトしました。再試行してください。":(null==e||null==(s=e.message)?void 0:s.includes("fetch"))?"分析サービスに接続できません。接続状況を確認してください。":(null==e?void 0:e.message)||"予期しないエラーが発生しました。"},isRetryableError(e){var s;return e instanceof o?e.status>=500||408===e.status||429===e.status||"TIMEOUT_ERROR"===e.code||"NETWORK_ERROR"===e.code:(null==e?void 0:e.name)==="TypeError"||(null==e||null==(s=e.message)?void 0:s.includes("fetch"))},createQueryKey(e,s){let t=["monthlySwing",e];return s&&t.push(s),t}};function u(){let[e,s]=(0,a.useState)(""),[t,n]=(0,a.useState)(null),{data:c,isLoading:o,error:d,errorMessage:m,refetch:u,hasData:g}=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{enabled:t=!0,staleTime:r=3e5,cacheTime:n=18e5,retry:l=3,onError:c,onSuccess:o}=s,d=e.trim().toUpperCase(),m={queryKey:h.createQueryKey("analysis",{symbol:d}),queryFn:()=>x.getAnalysis(d),enabled:t&&!!d,staleTime:r,gcTime:n,retry:(e,s)=>(!h.isMonthlySwingApiError(s)||!!h.isRetryableError(s))&&e<l,retryDelay:e=>Math.min(1e3*2**e,3e4)},u=(0,i.I)(m);return(0,a.useEffect)(()=>{u.isSuccess&&u.data&&o&&(console.log("Monthly swing analysis completed for ".concat(d)),o(u.data))},[u.isSuccess,u.data,d,o]),(0,a.useEffect)(()=>{u.isError&&u.error&&c&&(console.error("Monthly swing analysis failed for ".concat(d,":"),u.error),c(u.error))},[u.isError,u.error,d,c]),{...u,errorMessage:u.error?h.getErrorMessage(u.error):null,hasData:!!u.data,symbol:d}}(e,{enabled:!!e,onSuccess:e=>{n(e),console.log("✅ Monthly swing analysis completed for: ".concat(e.symbol))},onError:e=>{console.error("❌ Monthly swing analysis failed:",e),n(null)}}),p=async t=>{console.log("\uD83D\uDE80 Starting monthly swing analysis for symbol: ".concat(t)),n(null),s(t),t===e&&u()};return(0,r.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"space-y-12",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight text-neutral-900 sm:text-4xl",children:"月次スイングトレード分析"}),(0,r.jsxs)("p",{className:"mx-auto mt-4 max-w-2xl text-lg text-neutral-600",children:["1ヶ月程度の保有期間を想定したスイングトレード戦略のための",(0,r.jsx)("br",{}),"トレンド分析とシグナル生成システム"]})]}),(0,r.jsx)(l,{onAnalyze:p,isAnalyzing:o}),d&&(0,r.jsx)("div",{className:"mx-auto max-w-4xl",children:(0,r.jsx)("div",{className:"card border-red-200 bg-red-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-red-900 mb-2",children:"分析エラー"}),(0,r.jsx)("p",{className:"text-sm text-red-700",children:m||"エラーが発生しました。しばらく後に再試行してください。"}),e&&(0,r.jsx)("button",{onClick:()=>u(),className:"mt-4 rounded-md bg-red-600 px-4 py-2 text-sm font-semibold text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:"再試行"})]})})}),g&&t&&(0,r.jsx)("div",{className:"mx-auto max-w-6xl",children:(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-neutral-900",children:[t.symbol," - 月次スイング分析結果"]}),(0,r.jsxs)("p",{className:"mt-2 text-sm text-neutral-600",children:["分析実行日: ",new Date(t.analysis_date).toLocaleDateString("ja-JP")]})]}),(0,r.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h3",{className:"card-title",children:"トレンド方向"})}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"trend-indicator ".concat("上昇"===t.trend_strength.direction?"trend-up":"下降"===t.trend_strength.direction?"trend-down":"trend-sideways"),children:t.trend_strength.direction}),(0,r.jsxs)("p",{className:"mt-2 text-xs text-neutral-600",children:["強度: ",Math.round(100*t.trend_strength.strength),"%"]})]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h3",{className:"card-title",children:"継続確率"})}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-primary-600",children:[Math.round(100*t.continuation_probability),"%"]}),(0,r.jsx)("p",{className:"mt-2 text-xs text-neutral-600",children:"トレンド継続見込み"})]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h3",{className:"card-title",children:"分析信頼度"})}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-neutral-900",children:[Math.round(100*t.trend_strength.confidence),"%"]}),(0,r.jsx)("p",{className:"mt-2 text-xs text-neutral-600",children:"分析精度指標"})]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h3",{className:"card-title",children:"トレンド継続期間"})}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-neutral-900",children:[t.trend_strength.duration_days,"日"]}),(0,r.jsx)("p",{className:"mt-2 text-xs text-neutral-600",children:"現在のトレンド継続日数"})]})]})]}),t.swing_signals.length>0&&(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h3",{className:"card-title",children:"スイングトレードシグナル"})}),(0,r.jsx)("div",{className:"space-y-4",children:t.swing_signals.map((e,s)=>(0,r.jsxs)("div",{className:"border-l-4 border-primary-500 bg-primary-50 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("span",{className:"signal-".concat("買い"===e.signal_type?"buy":"売り"===e.signal_type?"sell":"保持"===e.signal_type?"hold":"wait"),children:[e.signal_type,"シグナル"]}),(0,r.jsxs)("span",{className:"text-sm text-neutral-600",children:["信頼度: ",Math.round(100*e.confidence),"%"]})]}),(e.target_price||e.stop_loss)&&(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.target_price&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"目標価格:"})," $",e.target_price.toFixed(2)]}),e.stop_loss&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"ストップロス:"})," $",e.stop_loss.toFixed(2)]})]}),e.supporting_factors.length>0&&(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-neutral-700 mb-1",children:"根拠:"}),(0,r.jsx)("ul",{className:"text-sm text-neutral-600 space-y-1",children:e.supporting_factors.map((e,s)=>(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"mr-2",children:"•"}),(0,r.jsx)("span",{children:e})]},s))})]})]},s))})]}),t.monthly_returns.length>0&&(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h3",{className:"card-title",children:"月次リターン履歴"})}),(0,r.jsxs)("div",{className:"text-center text-sm text-neutral-600",children:["過去 ",t.monthly_returns.length," ヶ月のパフォーマンス"]}),(0,r.jsx)("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:t.monthly_returns.slice(0,4).map((e,s)=>(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-lg font-bold ".concat(e.return_rate>=0?"metric-positive":"metric-negative"),children:[e.return_rate>=0?"+":"",(100*e.return_rate).toFixed(1),"%"]}),(0,r.jsxs)("div",{className:"text-xs text-neutral-600",children:[new Date(e.start_date).getMonth()+1,"月"]})]},s))})]})]})}),o&&(0,r.jsx)("div",{className:"mx-auto max-w-md",children:(0,r.jsx)("div",{className:"card animate-pulse",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-neutral-900",children:"月次スイング分析実行中"}),(0,r.jsxs)("p",{className:"mt-2 text-sm text-neutral-600",children:[e," の月次トレンドデータを分析しています..."]})]})})})]})})}}},e=>{e.O(0,[743,454,441,255,358],()=>e(e.s=4484)),_N_E=e.O()}]);